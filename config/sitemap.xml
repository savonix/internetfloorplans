<!--
Program: Internet Floor Plans
Component: sitemap.xml
Copyright: Savonix Corporation
Author: Albert L. Lash, IV
License: Gnu Affero Public License version 3
http://www.gnu.org/licenses

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation; either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program; if not, see http://www.gnu.org/licenses
or write to the Free Software Foundation,Inc., 51 Franklin Street,
Fifth Floor, Boston, MA 02110-1301  USA
-->
<map:sitemap xmlns:map="http://www.nexista.com/sitemap"> 
<!--
##     ## ########  ##       #### ##    ## ##    ## 
##     ## ##     ## ##        ##  ###   ## ##   ##  
##     ## ##     ## ##        ##  ####  ## ##  ##   
##     ## ########  ##        ##  ## ## ## #####    
##     ## ##        ##        ##  ##  #### ##  ##   
##     ## ##        ##        ##  ##   ### ##   ##  
 #######  ##        ######## #### ##    ## ##    ##
 -->
 
 	<map:prepend>
        <map:set name="prodgex_version" value="0.03"/>
		<map:script src="lib/php/runtime.php"/>
        <map:set name="theme" value="default"/>
        <map:set name="selected_lang" value="en_US"/>
		<map:xml src="data/xml/main_menu.xml"/>
		<map:xml src="i18n/{//selected_lang}/internetfloorplans.xml"/>
	</map:prepend>
    
<!-- *************************************************  -->
<!--    UPLINK LOCATIONS                               	-->
<!-- *************************************************  -->
	<map:gate name="ifp-index">
		<map:xsl src="templates/xsl/welcome.xsl" />
	</map:gate>	
	<map:gate name="ifp-locations">
        <!--
		<map:query src="data/sql/regions_get_all.xml" />
		<map:if name="//my_region_id">
			<map:true>
				<map:switch name="//my_region_id">
					<map:case value="all">
						<map:query src="data/sql/get_all_locations.xml" />
						<map:query src="data/sql/get_gt_locations.xml" />
					</map:case>
					<map:default>
						<map:query src="data/sql/get_locations_by_region_id.xml" />
						<map:query src="data/sql/get_gt_locations_by_region_id.xml" />
					</map:default>
				</map:switch>
			</map:true>
			<map:false>
				<map:query src="data/sql/get_all_locations.xml" />
				<map:query src="data/sql/get_gt_locations.xml" />
			</map:false>
		</map:if>
        -->
        <map:query src="data/sql/locations_get_all.xml" />
		<map:xsl src="templates/xsl/locations_view.xsl" />
	</map:gate>
	<map:gate name="ifp-loc-search" role="uplink_regional_manager">
		<map:action type="like" params="//_post/q"/>
		<map:query src="data/sql/search_locations.xml" />
		<map:xsl src="templates/xsl/view_locations.xsl" />
	</map:gate>
	
	<!-- Email locations-->
	<map:gate name="ifp-loc/email/" role="uplink_regional_manager">
		<map:xsl src="templates/xsl/email_locations.xsl"/>
	</map:gate>

	<!-- LOCAL MANAGER
	<map:gate name="ifp-my-loc" role="uplink_local_manager" >
		<map:query src="data/sql/get_my_locations.xml" />
		<map:xsl src="templates/xsl/view_my_locations.xsl" />
	</map:gate>
	<map:gate name="ifp-my-loc-view" role="uplink_local_manager" >
		<map:query src="data/sql/get_my_locations.xml" />
		<map:query src="data/sql/get_location_summary.xml" />
		<map:query src="data/sql/get_location_images.xml" />
		<map:xsl src="templates/xsl/view_my_location.xsl" />
	</map:gate>
	<map:gate name="ifp-my-loc-view-sp" role="uplink_local_manager" >
		<map:query src="data/sql/get_my_locations.xml" />
		<map:query src="data/sql/get_location_summary.xml" />
		<map:query src="data/sql/get_location_space_plans.xml" />
		<map:xsl src="templates/xsl/view_my_location_sp.xsl" />
	</map:gate>

	<map:gate name="ifp-my-loc-guidelines" role="uplink_local_manager" >
		<map:query src="data/sql/get_my_locations.xml" />
		<map:query src="data/sql/get_location_summary.xml" />
		<map:xsl src="templates/xsl/guidelines.xsl" />
	</map:gate>
	<map:gate name="ifp-my-loc-install" role="uplink_local_manager">
		<map:xsl src="templates/xsl/install_equipment_content.xsl" />
	</map:gate>
	<map:gate name="ifp-my-loc-install-submit" role="uplink_local_manager">
		<map:query src="data/sql/install_equipment_content.xml" />
		<map:action type="redirect" params="/ifp-my-loc-"/>
	</map:gate>
    
	<map:gate name="ifp-my-loc-view-add">
		<map:query src="data/sql/get_my_locations.xml" />
		<map:query src="data/sql/get_location_summary.xml" />
		
		<map:xsl src="templates/xsl/my_new_location_image.xsl" />
	</map:gate>
	<map:gate name="ifp-my-loc-view-add-submit" role="client" >
		
		<map:if name="_post/submit">
			<map:true>
				<map:validate src="uplink/modules/locations/validators/image_validator.xml">
					<map:valid>
						<map:if name="//_post/default">
							<map:true>
								<map:query src="data/sql/no_default_image.xml"/>
							</map:true>
						</map:if>
						<map:action type="upload" params="file,//_post/dest"/>
						<map:switch name="//_files/file/type">
							<map:case value="image/gif">
								<map:query src="data/sql/add_location_gif_image.xml"/>
							</map:case>
							<map:case value="video/quicktime">
								<map:query src="data/sql/add_location_gif_image.xml"/>
							</map:case>
							<map:default>
								<map:action type="thumbnail" params="//_files/file/new_name,256,256,thumb_"/>
								<map:query src="data/sql/add_location_image.xml"/>
							</map:default>
						</map:switch>
						<map:action type="redirect" params="/ifp-my-loc-"/>
					</map:valid>
					<map:invalid>
						<map:xsl src="templates/xsl/new_location_image.xsl" />
					</map:invalid>
				</map:validate>
			</map:true>
			<map:false>
				<map:xsl src="templates/xsl/new_location_image.xsl" />
			</map:false>
			
		</map:if>
	</map:gate>
     -->

	<map:gate name="ifp-loc-new-submit" role="client">
		<map:if name="_post/submit">
			<map:true>
				<map:switch name="_post/submit">
					<map:case value="Submit">
                        <map:query src="data/sql/new_location.xml" />
                        <map:query src="data/sql/get_last_location_address_id.xml" />
                        <map:query src="data/sql/new_location_regions.xml" />
                        <map:action type="redirect" params="/ifp-loc/" />
					</map:case>
					<map:default>
						<map:query src="data/sql/get_all_regions.xml" />
						<map:xsl src="templates/xsl/edit_location_form.xsl" />
					</map:default>
				</map:switch>
			</map:true>
			<map:false>
				<map:query src="data/sql/get_all_regions.xml" />
				<map:xsl src="templates/xsl/edit_location_form.xsl" />
			</map:false>
		</map:if>
	</map:gate>
			
	<!-- Delete location -->
    <map:gate name="ifp-loc-del" role="client">
		<map:if name="_get/location_address_id">
			<map:true>
				<map:query src="data/sql/del_loc.xml" />
				<map:query src="data/sql/del_loc_image_by_loc.xml" />
				<map:query src="data/sql/del_loc_space_plan_by_loc.xml" />
				<map:query src="data/sql/get_loc_equipment_ids.xml" />
				<map:query src="data/sql/del_loc_equipment_pos_by_loc.xml" />
				<map:query src="data/sql/del_loc_equipment_by_loc.xml" />
				<map:action type="redirect" params="/ifp-loc/" />
			</map:true>
			<map:false>
				<map:action type="redirect" params="/ifp-loc/"/>
			</map:false>
		</map:if>
    </map:gate>

<!-- Edit Location -->
<map:gate name="ifp-location-edit" role="client">
	<map:if name="_post/submit">
		<map:true>
            <map:query src="data/sql/location_create.xml" />
            <map:action type="redirect" params="{//link_prefix}ifp-locations" />
		</map:true>
		<map:false>
			<map:query src="data/sql/regions_get_all.xml" />
			<map:xsl src="templates/xsl/location_form.xsl" />
		</map:false>
	</map:if>
</map:gate>

	<!-- ############################### -->
	<!-- View location image library -->
	<map:gate name="ifp-location-view" role="client" >
        <!--
		<map:if name="_post/submit">
			<map:true>
				<map:validate src="uplink/modules/locations/validators/image_validator.xml">
					<map:valid>
						<map:if name="//_post/default">
							<map:true>
								<map:query src="data/sql/no_default_image.xml"/>
							</map:true>
						</map:if>
						<map:action type="upload" params="file,//_post/dest,//_post/prefix"/>
						<map:switch name="//_files/file/type">
							<map:case value="image/gif">
								<map:query src="data/sql/add_location_gif_image.xml"/>
							</map:case>
							<map:case value="video/quicktime">
								<map:query src="data/sql/add_location_gif_image.xml"/>
							</map:case>
							<map:default>
								<map:action type="thumbnail" params="//_files/file/new_name,256,256,thumb_"/>
								<map:query src="data/sql/add_location_image.xml"/>
							</map:default>
						</map:switch>
						<map:query src="data/sql/get_location_summary.xml" />
						<map:query src="data/sql/get_location_images.xml" />
						<map:xsl src="templates/xsl/view_location.xsl" />
					</map:valid>
					<map:invalid>
						
						<map:query src="data/sql/get_location_summary.xml" />
						<map:xsl src="templates/xsl/new_location_image.xsl" />
					</map:invalid>
				</map:validate>
			</map:true>
			<map:false>
				<map:query src="data/sql/get_location_summary.xml" />
				<map:query src="data/sql/get_location_images.xml" />
				<map:xsl src="templates/xsl/location_view.xsl" />
			</map:false>
		</map:if>
        -->
        <map:xsl src="templates/xsl/location_view.xsl" />
	</map:gate>
    
	<!-- Add new image -->
	<map:gate name="ifp-location-image-edit" role="client">
		<map:query src="data/sql/location_get_summary.xml" />
		<map:xsl src="templates/xsl/location_image_form.xsl" />
		
	</map:gate>

	<!-- Delete image -->
	<map:gate name="ifp-location-image-delete" role="client" >
		<map:query src="data/sql/location_image_delete.xml"/>
		<map:action type="redirect" params="{//link_prefix}ifp-locations"/>
	</map:gate>
	
	<!-- View location space plans -->
	<map:gate name="ifp-location-space-plans" role="client" cache="0">
		<map:if name="//delete">
			<map:true>
				<map:query src="data/sql/get_equipment_by_id.xml"/>
				<map:query src="data/sql/delete_equipment.xml"/>
				<map:query src="data/sql/delete_equipment_location.xml"/>
				<map:query src="data/sql/delete_equipment_container.xml"/>
				<map:query src="data/sql/delete_location_equipment_position.xml" />
				<map:block name="clear_cache">
				
				
				</map:block>
			</map:true>
			<map:false>
			</map:false>
		</map:if>
		<map:if name="//_post/submit">
			<map:true>
				<map:query src="data/sql/add_equipment.xml"/>
				<map:query src="data/sql/get_last_equipment_id.xml"/>
				<map:query src="data/sql/add_equipment_location.xml"/>
				<map:query src="data/sql/get_last_location_equipment_id.xml"/>
				<map:query src="data/sql/add_equipment_location_position.xml"/>
				<map:query src="data/sql/get_eqp_containers_by_type_id.xml"/> 
				<map:query src="data/sql/add_equipment_containers.xml"/>
			</map:true>
			<map:false>
			</map:false>
		</map:if>
		<map:block name="sp_view">
            <!--
			<map:query src="data/sql/get_location_summary.xml" />
			<map:query src="data/sql/get_location_space_plans.xml" />
			<map:query src="data/sql/get_equipment_types.xml"/>
            -->
			<map:xsl src="templates/xsl/location_space_plan.xsl" />
		</map:block>
	</map:gate>
	
	<map:gate name="ifp-location-space-plan-key-update" role="uplink">
		<map:query src="data/sql/edit_space_plan_key_position.xml"/>
	</map:gate>
	
	
	<!-- PDF OF FLOORPLAN -->

	<map:gate name="ifp-location-space-plan-pdf-server" role="uplink">
		<map:query src="data/sql/get_location_summary.xml" />
		<map:query src="data/sql/get_location_space_plans.xml" />
		<map:query src="data/sql/get_equipment_types.xml"/>
		<map:query src="data/sql/get_sp_pointer_by_id.xml" />
		<map:query src="data/sql/get_location_space_plan_assets.xml" />
		<map:query src="data/sql/get_account_symbol_pointers.xml" />
		<map:script src="lib/php/floorplan_pdf.php"/>
	</map:gate>
	
	
	
	<!-- Add new plan -->
	<map:gate name="ifp-location-space-plan-add" role="client" >
		<map:if name="//_post/submit">
			<map:true>
				<map:action type="upload" params="file,//_post/dest"/>
				<map:script src="uplink/modules/locations/php/floorplan_processor.php"/>
				<map:query src="data/sql/add_location_space_plan.xml"/>
				<map:insert name="sp_view"/>
			</map:true>
			<map:false>
				<!-- have to get user's account for destination variable of form - BAD! -->
				
				<map:query src="data/sql/get_location_summary.xml" />
				<map:xsl src="templates/xsl/new_location_space_plan.xsl" />
			</map:false>
		</map:if>
	</map:gate>
	
	<!-- Delete plan -->
	<map:gate name="ifp-location-space-plan-delete" role="client" >
		<map:query src="data/sql/delete_location_space_plan.xml"/>
		<map:insert name="clear_cache"/>
		<map:action type="redirect" params="/ifp-loc/"/>
	</map:gate>
	<!-- edit space plan comments -->
	<map:gate name="ifp-location-space-plan-edit" role="client">
        <map:query src="data/sql/get_location_summary.xml" />
        <map:query src="data/sql/get_location_space_plans.xml" />
        <map:query src="data/sql/get_equipment_types.xml"/>
        <map:query src="upsell/modules/lines_of_business/qry/get_lines_of_business.xml"/>
        <map:query src="upsell/modules/priorities/qry/get_priorities.xml"/>
        <map:xsl src="templates/xsl/view_location_sp.xsl" />
	</map:gate>

	<map:gate name="ifp-loc/view/sp/edit/submit/" role="client">	
		<map:insert name="clear_cache"/>
		<map:query src="data/sql/edit_location_space_plan.xml" />
		<map:query src="data/sql/get_location_summary.xml" />
		<map:query src="data/sql/get_location_space_plans.xml" />
		<map:query src="data/sql/get_equipment_types.xml"/>
		<map:query src="upsell/modules/lines_of_business/qry/get_lines_of_business.xml"/>
		<map:query src="upsell/modules/priorities/qry/get_priorities.xml"/>
		<map:xsl src="templates/xsl/view_location_sp.xsl" />
	</map:gate>


	<!-- View location hours of operation -->
	<map:gate name="ifp-loc/view/hours/" role="client" >
		<map:if name="//_post">
			<map:true>
				<map:action type="timeconvert" params="//_post/open_h,//_post/open_m,//_post/open_am_pm,open"/>
				<map:action type="timeconvert" params="//_post/close_h,//_post/close_m,//_post/close_am_pm,close"/>
				<map:query src="data/sql/del_location_hours.xml" />
				<map:query src="data/sql/add_location_hours.xml" />
			</map:true>
		</map:if>
		<map:query src="data/sql/get_location_summary.xml" />
		<map:script src="uplink/modules/locations/php/weekdays.php"/>
		<map:query src="data/sql/get_location_hours.xml" />
		<map:xsl src="templates/xsl/view_location_hours.xsl" />
		<map:debug dump="truse"/>
	</map:gate>
		<!-- Edit location hours of operation -->
	<map:gate name="ifp-loc/view/hours/edit/" role="client" >
		<map:query src="data/sql/get_location_summary.xml" />
		<!--<map:query src="data/sql/get_location_hours.xml" />-->
		<map:script src="uplink/modules/locations/php/dayhours.php"/>
		<map:xsl src="templates/xsl/edit_location_hours.xsl" />
	</map:gate>

	<!-- Delete location hours of operation -->
	<map:gate name="ifp-loc/view/hours/delete/" role="client" >
		<map:query src="data/sql/del_location_hours.xml" />
		<map:action type="redirect" params="/ifp-loc/"/>
	</map:gate>	
	
	<!-- View location equipment -->
	<map:gate name="ifp-location-equipment-quantities" role="client">
        <!--
		<map:query src="data/sql/get_location_summary.xml" />
		<map:query src="data/sql/get_equipment_types.xml"/>
		<map:query src="data/sql/get_location_assets.xml"/>  -->
		<map:xsl src="templates/xsl/location_equipment.xsl" />
	</map:gate>	
		
	<!-- View location equipment list -->
	<map:gate name="ifp-location-equipment-list" role="client">
    <!--
		<map:query src="data/sql/get_location_summary.xml" />
		<map:query src="data/sql/get_equipment_types.xml"/>
		<map:query src="data/sql/get_location_asset_details.xml"/>  -->
		<map:xsl src="templates/xsl/location_equipment_list.xsl" />
	</map:gate>	
	
	<!-- Edit location equipment -->
	<map:gate name="ifp-loc/view/eqp/edit_loc/" role="client">
		<map:insert name="clear_cache"/>
		<!--<map:query src="data/sql/delete_location_equipment_position.xml" />-->
		<map:query src="data/sql/edit_location_equipment_position.xml"/>
	</map:gate>	
	
<!-- *************************************************  -->
<!--  
########  ########  ######   ####  #######  ##    ##  ######  
##     ## ##       ##    ##   ##  ##     ## ###   ## ##    ## 
##     ## ##       ##         ##  ##     ## ####  ## ##       
########  ######   ##   ####  ##  ##     ## ## ## ##  ######  
##   ##   ##       ##    ##   ##  ##     ## ##  ####       ## 
##    ##  ##       ##    ##   ##  ##     ## ##   ### ##    ## 
##     ## ########  ######   ####  #######  ##    ##  ######  
-->
<!-- *************************************************  -->

	<map:gate name="ifp-regions">
		<map:switch name="_post/submit">
			<map:case value="Delete">
				<map:query src="data/sql/del_regions.xml" />
                <map:action type="redirect" params="{//link_prefix}ifp-regions"/>
			</map:case>
			<map:default>
			</map:default>
		</map:switch>
		<map:if name="_post/submit">
			<map:true>
			</map:true>
			<map:false>
				<map:query src="data/sql/regions_get_all.xml" />
				<map:xsl src="templates/xsl/regions_view_all.xsl" />
			</map:false>
		</map:if>
	</map:gate>
	
	<!-- New region -->
	<map:gate name="ifp-region-edit" role="client" >
		<map:if name="_post/submit">
			<map:true>
				<map:query src="data/sql/region_create.xml"/>
                <map:action type="redirect" params="{//link_prefix}ifp-regions"/>
            </map:true>
			<map:false>
                <map:query src="data/sql/locations_get_all.xml" />
				<map:xsl src="templates/xsl/region_form.xsl" />
			</map:false>
		</map:if>
	</map:gate>

	<!-- Region view and edit -->
	<map:gate name="ifp-region" role="client" >
		<map:if name="_post/submit">
			<map:true>
				<map:query src="data/sql/del_regions.xml" />
				<map:query src="data/sql/update_region.xml" />
				<map:query src="data/sql/del_region_locations.xml" />
				<map:query src="data/sql/update_region_locations.xml" />
                <map:action type="redirect" params="{//link_prefix}ifp-regions"/>
			</map:true>
			<map:false>
				<map:query src="data/sql/locations_get_all.xml" />
				<map:xsl src="templates/xsl/region_view.xsl" />
			</map:false>
		</map:if>
	</map:gate>
	<!-- Delete Regions -->
	<map:gate name="ifp-rgn/del/multiple/" role="client">
		<map:query src="data/sql/del_regions.xml" />
	</map:gate>

<!-- *************************************************  

########  #######  ##     ## #### ########  ##     ## ######## ##    ## ######## 
##       ##     ## ##     ##  ##  ##     ## ###   ### ##       ###   ##    ##   
##       ##     ## ##     ##  ##  ##     ## #### #### ##       ####  ##    ##   
######   ##     ## ##     ##  ##  ########  ## ### ## ######   ## ## ##    ##   
##       ##  ## ## ##     ##  ##  ##        ##     ## ##       ##  ####    ##   
##       ##    ##  ##     ##  ##  ##        ##     ## ##       ##   ###    ##   
########  ##### ##  #######  #### ##        ##     ## ######## ##    ##    ##   

 *************************************************  -->
	<!-- View all equipment -->
	<map:gate name="ifp-equipment" role="client">
		<map:query src="data/sql/equipment_get_all.xml"/>
		<map:xsl src="templates/xsl/equipment_view_all.xsl"/>
	</map:gate>
	<map:gate name="ifp-equipment-quantities" role="client">
		<map:query src="data/sql/get_equipment_types.xml"/>
		<map:query src="data/sql/get_all_equipment.xml"/>
		<map:xsl src="templates/xsl/view_all_equipment_q.xsl"/>
	</map:gate>
	<!-- New equipment form -->
	<map:gate name="ifp-equipment-edit" role="client">
		<map:if name="//_post/submit">
			<map:true>
				<map:switch name="//_post/type">
					<map:case value="new">
						<map:query src="data/sql/add_equipment.xml"/>
						<map:query src="data/sql/get_last_equipment_id.xml"/>
						<map:query src="data/sql/add_equipment_location.xml"/>
						<map:query src="data/sql/get_last_location_equipment_id.xml"/>
						<map:query src="data/sql/add_equipment_location_position.xml"/>
						<map:query src="data/sql/get_eqp_containers_by_type_id.xml"/>
						<map:query src="data/sql/add_equipment_containers.xml"/>
					</map:case>
					<map:case value="edit">
						<map:query src="data/sql/edit_equipment_container.xml"/>
					</map:case>	
					<map:default>
					</map:default>
				</map:switch>
			</map:true>
		</map:if>
		<map:query src="data/sql/get_location_summary.xml"/>
		<map:query src="upsell/modules/lines_of_business/qry/get_lines_of_business.xml"/>
		<map:query src="upsell/modules/priorities/qry/get_priorities.xml"/>
		<map:query src="data/sql/get_equipment_types.xml"/>
		<map:if name="_get/equipment_id">
			<!-- EDIT FORM-->
			<map:true>
				<map:query src="data/sql/get_equipment_by_id.xml"/>
				<map:query src="data/sql/get_eqp_containers_by_type_id.xml"/>
				<map:query src="data/sql/get_eqp_containers_by_id.xml"/>
				<map:xsl src="templates/xsl/edit_equipment_form.xsl"/>
			</map:true>
			<map:false>
				<map:xsl src="templates/xsl/new_equipment_form.xsl"/>
			</map:false>
		</map:if>
		<map:debug dump="trsue"/>
	</map:gate>
	<map:gate name="ifp-equipment-edit-submit" role="client">
	<map:if name="//_post/submit">
		<map:true>
			<map:switch name="//_post/type">
				<map:case value="new">
					<map:query src="data/sql/add_equipment.xml"/>
					<map:query src="data/sql/get_last_equipment_id.xml"/>
					<map:query src="data/sql/add_equipment_location.xml"/>
					<map:query src="data/sql/get_last_location_equipment_id.xml"/>
					<map:query src="data/sql/add_equipment_location_position.xml"/>
					<!-- get equipment_type containers-->
					<map:query src="data/sql/get_eqp_containers_by_type_id.xml"/>
					<!-- for each container, set default priorities and campaigns-->
					<map:query src="data/sql/add_equipment_containers.xml"/>
				</map:case>
				<map:case value="edit">
					<map:query src="data/sql/edit_equipment_container.xml"/>
				</map:case>	
				<map:default>
				</map:default>
			</map:switch>
			<map:action type="redirect" params="/ifp-assets/"/>
		</map:true>
	</map:if>
	</map:gate>
	<map:gate name="ifp-assets/edit/submit2/" role="client">
		<map:if name="_post/submit">
			<map:true>
				<map:query src="data/sql/delete_equipment.xml"/>
				<map:query src="data/sql/edit_equipment.xml"/>
			</map:true>
		</map:if>
	</map:gate>
	<!-- Delete equipment -->
	<map:gate name="ifp-equipment-delete" role="client">
		<map:query src="data/sql/get_equipment_by_id.xml"/>
		<map:query src="data/sql/delete_equipment.xml"/>
		<map:query src="data/sql/delete_equipment_location.xml"/>
		<map:query src="data/sql/delete_equipment_container.xml"/>
		<map:query src="data/sql/delete_location_equipment_position.xml" />
		<map:action type="redirect" params="{//link_prefix}ifp-equipment"/>
	</map:gate>
    
	<!-- equipment Categories -->
	<map:gate name="ifp-depts/" role="client" >
		<map:query src="data/sql/get_equipment_categories.xml" />
		<map:xsl src="templates/xsl/view_equipment_categories.xsl" />
	</map:gate>	
	<map:gate name="ifp-depts/edit/" role="client" >
		<map:if name="_post/submit">
			<map:true>
				<map:if name="_post/equipment_category_id">
					<!-- Update the existing category -->
					<map:true>
						<map:query src="data/sql/delete_equipment_category.xml" />
						<map:query src="data/sql/edit_equipment_category.xml" />
						<map:action type="redirect" params="/ifp-depts/"/>
					</map:true>
					<!-- Create a new category -->
					<map:false>
						<map:query src="data/sql/add_equipment_category.xml" />
						<map:action type="redirect" params="/ifp-depts/"/>
					</map:false>
				</map:if>
			</map:true>
			<map:false>
				<map:if name="_get/equipment_category_id">
					<map:true>
						<map:query src="data/sql/get_equipment_category_by_id.xml"/>
					</map:true>
				</map:if>
				<map:xsl src="templates/xsl/new_equipment_category_form.xsl" />
			</map:false>
		</map:if>
	</map:gate>	
    
	<!-- equipment Types -->
	<map:gate name="ifp-equipment-types" role="client" >
		<map:query src="data/sql/get_equipment_types.xml" />
		<map:xsl src="templates/xsl/view_equipment_types.xsl" />
	</map:gate>	
	<!-- View equipment type images -->
	<map:gate name="ifp-equipment-type" role="client" >
		<map:block name="type_images">
		<map:query src="data/sql/get_equipment_type_by_id.xml" />
		<map:query src="data/sql/get_equipment_type_images.xml" />
		<map:xsl src="templates/xsl/view_equipment_type.xsl" />
		</map:block>
	</map:gate>

	<!-- ############################### -->
	<!-- Add new equipment image -->
	<map:gate name="ifp-equipment-type-edit" role="client">
		<map:query src="data/sql/get_equipment_type_by_id.xml" />
		
		<map:xsl src="templates/xsl/new_equipment_image.xsl" />
	</map:gate>
    
	<map:gate name="ifp-equipment-type-edit-submit" role="client" >
		<map:if name="_post/submit">
			<map:true>
                <map:action type="upload" params="file,//_post/dest"/>
                <map:query src="data/sql/add_equipment_image.xml"/>
				<map:insert name="type_images"/>
             </map:true>
			<map:false>
				<map:xsl src="templates/xsl/new_equipment_image.xsl" />
			</map:false>
		</map:if>
	</map:gate>
	<map:gate name="ifp-types/view/delete/" role="client" >
		<map:query src="data/sql/delete_equipment_type_image.xml"/>
		<map:action type="redirect" params="/ifp-types/"/>
	</map:gate>

	<!-- Add new plan symbol -->
	<map:gate name="ifp-types/view/sp/add/" role="client">
		
		<map:query src="data/sql/get_equipment_type_by_id.xml" />
		<map:xsl src="templates/xsl/new_equipment_type_symbol.xsl" />
	</map:gate>
	<map:gate name="ifp-types/view/sp/add/submit/" role="client" >
		
		<map:if name="_post/submit">
			<map:true>
				<map:validate src="uplink/modules/equipment/validators/symbol_validator.xml">
					<map:valid>
						<map:if name="//_post/default">
							<map:true>
								<map:query src="data/sql/no_default_symbol.xml"/>
							</map:true>
						</map:if>
						<map:action type="upload" params="file,//_post/dest"/>
						<map:script src="lib/php/symbol_processor.php"/>
						<map:query src="data/sql/add_equipment_type_symbol.xml"/>
						<map:action type="redirect" params="/ifp-types/"/>
					</map:valid>
					<map:invalid>
						<map:xsl src="templates/xsl/new_equipment_type_symbol.xsl" />
					</map:invalid>
				</map:validate>
			</map:true>
			<map:false>
				<map:xsl src="templates/xsl/new_equipment_type_symbol.xsl" />
			</map:false>
		</map:if>
	</map:gate>
	<!-- Delete symbol -->
	<map:gate name="ifp-types/view/sp/delete/" role="client" >
		<map:query src="data/sql/delete_equipment_type_symbol.xml"/>
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
	</map:gate>
	
	<!-- View equipment type symbols -->
	<map:gate name="ifp-equipment-type-symbols" role="client">
		<map:query src="data/sql/equipment_type_get_by_id.xml" />
		<map:query src="data/sql/get_equipment_type_symbols.xml" />
		<map:xsl src="templates/xsl/view_equipment_type_symbols.xsl" />
	</map:gate>	
	<map:gate name="ifp-types/edit/" role="client" >
		<map:if name="_post/submit">
			<map:true>
				<map:if name="_post/equipment_type_id">
					<map:true>
						<map:query src="data/sql/delete_equipment_type.xml" />
						<map:query src="data/sql/edit_equipment_type.xml" />
					</map:true>
					<map:false>
						<map:query src="data/sql/add_equipment_type.xml" />
					</map:false>
				</map:if>
				<map:action type="redirect" params="/ifp-types/"/>
			</map:true>
			<map:false>
				<map:if name="_get/equipment_type_id">
					<map:true>
						<map:query src="data/sql/get_equipment_type_by_id.xml"/>
					</map:true>
				</map:if>
					<map:query src="data/sql/get_equipment_categories.xml" />
					<map:xsl src="templates/xsl/new_equipment_type_form.xsl" />
			</map:false>
		</map:if>
	</map:gate>		
	<!-- Delete equipment Types -->
	<map:gate name="ifp-equipment-type-delete" role="client" >
		<map:query src="data/sql/delete_equipment_type.xml" />
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
	</map:gate>	
	
	<!-- CONFIGURE EQUIPMENT CONTAINERS -->
	<map:gate name="ifp-equipment-type-containers">
		<map:query src="data/sql/get_equipment_type_by_id.xml" />
		<map:query src="data/sql/get_eqp_containers_by_type_id.xml" />
		<map:query src="uplink/modules/containers/qry/get_container_types.xml" />
		<map:query src="data/sql/get_equipment_type_images.xml" />
		<map:xsl src="templates/xsl/view_equipment_containers.xsl" />
	</map:gate>
	<!-- ADD EQUIPMENT CONTAINERS -->
	<map:gate name="ifp-equipment-type-container-edit">
		<map:query src="uplink/modules/containers/qry/add_equipment_containers.xml" />
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
	</map:gate>	
	<!-- DELETE EQUIPMENT CONTAINERS -->
	<map:gate name="ifp-equipment-type-container-delete">
		<map:query src="uplink/modules/containers/qry/del_equipment_containers.xml" />
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
	</map:gate>	
	<!-- CONTAINER EDIT MENU --> 
	<map:gate name="ifp-types/containers/code/">
		<map:if name="//_post">
			<map:true>
				<map:query src="uplink/modules/containers/qry/edit_equipment_type_containers.xml"/>
			</map:true>
			<map:false>
			</map:false>
		</map:if>
		<map:query src="upsell/modules/priorities/qry/get_priorities.xml"/>
		<map:query src="upsell/modules/lines_of_business/qry/get_lines_of_business.xml"/>
		<map:query src="data/sql/get_equipment_type_by_id.xml" />
		<map:query src="data/sql/get_eqp_containers_by_type_id.xml" />
		<map:query src="uplink/modules/containers/qry/get_container_types.xml" />
		<map:xsl src="templates/xsl/view_equipment_container_codes.xsl" />
	</map:gate>
	
	
	
	<!-- LIST CONTAINERS -->
	<map:gate name="ifp-containers" >
		<map:query src="uplink/modules/containers/qry/get_container_types.xml" />
		<map:xsl src="uplink/modules/containers/xsl/view_container_types.xsl" />
	</map:gate>
	
	<!-- ADD CONTAINER -->
<map:gate name="ifp-containers/edit/" role="uplink" >
	<map:if name="_get/container_id">
		<map:true>
			<map:query src="uplink/modules/containers/qry/get_container_type_by_id.xml"/>
			<map:xsl src="uplink/modules/containers/xsl/container_type_form.xsl"/>
		</map:true>
		<map:false>
			<map:xsl src="uplink/modules/containers/xsl/container_type_form.xsl"/>
		</map:false>
	</map:if>
</map:gate>
	
<map:gate name="ifp-containers/edit/submit/" role="uplink">
	<map:switch name="_post/type">
		<map:case value="new">
			<map:query src="uplink/modules/containers/qry/new_container_type.xml"/>
		</map:case>
		<map:case value="edit">
			<map:query src="uplink/modules/containers/qry/del_container_type.xml"/>
			<map:query src="uplink/modules/containers/qry/edit_container_type.xml"/>
		</map:case>
		<map:default>
			<map:query src="uplink/modules/containers/qry/new_container_type.xml"/>
		</map:default>
	</map:switch>
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
</map:gate>

<!-- DELETE CONTAINER TYPE-->
<map:gate name="ifp-containers/delete/" role="uplink">
	<map:query src="uplink/modules/containers/qry/del_container_type.xml"/>
    <map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
</map:gate>

<!-- Symbol and Image servers -->
	<map:gate name="ifp-types/display_config/" role="client">		
		<map:query src="upsell/modules/lines_of_business/qry/get_lines_of_business.xml"/>
		<map:query src="upsell/modules/priorities/qry/get_priorities.xml"/>
		<map:query src="data/sql/get_equipment_by_id_p.xml"/>
		<map:query src="data/sql/post_eqp_containers_by_type_id.xml" />
		<map:xsl src="templates/xsl/display_equipment_config.xsl"/>
	</map:gate>

	
	<map:gate name="ifp-equipment-types-symbol-server" role="client" >
		<map:query src="data/sql/get_symbol_pointer_by_id.xml" />
		<map:script src="uplink/modules/equipment/php/show_symbol.php" />
	</map:gate>
	
	<!-- FLASH SERVER!!!! -->
	<map:gate name="ifp-types/containers/position_server/">
		<map:query src="data/sql/get_eqp_containers_by_type_id.xml" />
		<map:query src="data/sql/get_image_pointer_by_id.xml" />
		<map:script src="lib/php/display_position_containers.php" />
	</map:gate>
	<!-- CONTAINER POSITIONER -->
	<map:gate name="ifp-container-position" role="client">
		<map:query src="data/sql/pos_equipment_container.xml" />
	</map:gate>
	
	<!-- CONTENT DISPLAYER ON MERCHANDISING -->
	<map:gate name="ifp-content/position_server/" role="client">
		<map:query src="data/sql/get_eqp_containers_by_type_id.xml" />
		<map:query src="data/sql/get_image_pointer_by_id.xml" />
		<map:query src="data/sql/get_equipment_content.xml" />
		<map:query src="data/sql/get_image_pointers_by_id.xml" />
		<map:script src="lib/php/display_equipment_setup.php" />
	</map:gate>	
	<!-- CONTENT DISPLAYER ON MERCHANDISING -->
	<map:gate name="ifp-content/position2/" role="client">
		<map:query src="data/sql/get_eqp_containers_by_type_id.xml" />
		<map:query src="data/sql/get_image_pointer_by_id.xml" />
		<map:query src="data/sql/get_equipment_content.xml" />
		<map:query src="data/sql/get_image_pointers_by_id.xml" /><!--
		<map:script src="uplink/modules/equipment/php/display_equipment_setup.php" />-->
	</map:gate>
	
	<!-- MING SPACE PLAN SERVER -->
	<map:gate name="ifp-location-space-plan-server" role="client">
		<map:query src="data/sql/get_sp_pointer_by_id.xml" />
		<map:query src="data/sql/get_location_space_plan_assets.xml" />
		<map:query src="data/sql/get_account_symbol_pointers.xml" />
		<map:script src="uplink/modules/locations/php/floorplan_generator.php" />
	</map:gate>	
	<!-- MING SPACE PLAN SERVER what is this 12-15-06?-->
	<map:gate name="ifp-types/containers/nu_sp_server2/" role="client">
		<map:query src="data/sql/get_sp_pointer_by_id.xml" />
		<map:query src="data/sql/get_location_space_plan_assets.xml" />
		<map:query src="data/sql/get_account_symbol_pointers.xml" />
		<map:debug dump="true"/>
<!--
		<map:script src="uplink/modules/locations/php/floorplan_generator.php" />-->
	</map:gate>
    
    

    <map:gate name="ifp-themed-css" cache="0">
        <map:action type="content" params="text/css"/>
        <map:raw src="templates/themes/{//theme}/default.css" />
    </map:gate>

    <map:gate name="license" cache="300">
    <map:action type="content" params="text/plain"/>
        <map:raw src="LICENSE" />
    </map:gate>
</map:sitemap>
