<!--
Program: Internet Floor Pla
Component: sitemap.x
Copyright: Savonix Corporati
Author: Albert L. Lash, 
License: Gnu Affero Public License version 
http://www.gnu.org/licens

This program is free software; you can redistribute it and/or modi
it under the terms of the GNU Affero General Public License as published 
the Free Software Foundation; either version 3 of the License, 
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty 
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See t
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public Licen
along with this program; if not, see http://www.gnu.org/licens
or write to the Free Software Foundation,Inc., 51 Franklin Street,
Fifth Floor, Boston, MA 02110-1301  U
-->
<map:sitemap xmlns:map="http://www.nexista.com/sitemap">
 	<map:prepend>
        <map:action type="server" value="-"/>
        <map:set name="ifp_version" value="0.01"/>
		<map:script src="lib/php/runtime.php"/>
        <map:set name="theme" value="default"/>
        <map:set name="link_color" value="green"/>
        <map:set name="selected_lang" value="en_US"/>
		<map:xml src="data/xml/main_menu.xml"/>
		<map:xml src="i18n/{//selected_lang}/internetfloorplans.xml"/>
	</map:prepend>


<!-- LOCATIONS -->
	<map:gate name="ifp-index" role="client">
		<map:xsl src="templates/xsl/welcome.xsl"/>
	</map:gate>
	<map:gate name="ifp-locations" role="client">
        <map:query src="data/sql/locations_get_all.xml"/>
		<map:xsl src="templates/xsl/locations_view.xsl"/>
	</map:gate>
    <!-- Create locations -->
    <map:gate name="ifp-location-create" role="client">
        <map:query src="data/sql/location_create.xml"/>
        <map:query src="data/sql/location_get_id.xml"/>
        <map:action type="redirect" params="{//link_prefix}ifp-location-edit&amp;location_id={//location_id}" />
    </map:gate>

    <!-- Edit Location -->
    <map:gate name="ifp-location-edit" role="client">
        <map:query src="data/sql/location_get_summary.xml"/>
        <map:query src="data/sql/regions_get_all.xml"/>
        <map:query src="data/sql/locations_get_by_region_id.xml"/>
        <map:xsl src="templates/xsl/location_form.xsl"/>
    </map:gate>
	<map:gate name="ifp-location-edit-submit" role="client">
		<map:if name="_post/submit">
            <map:true>
                <map:query src="data/sql/location_edit.xml"/>
                <map:query src="data/sql/location_regions_delete.xml"/>
                <map:query src="data/sql/location_regions_create.xml"/>
                <map:action type="redirect" params="{//link_prefix}ifp-locations"/>
			</map:true>
			<map:false>
                <map:query src="data/sql/regions_get_all.xml"/>
                <map:xsl src="templates/xsl/location_form.xsl"/>
			</map:false>
		</map:if>
	</map:gate>
	<!-- Delete location -->
    <map:gate name="ifp-location-delete" role="client">
        <map:query src="data/sql/location_delete.xml"/>
    </map:gate>


	<!-- View location image library -->
	<map:gate name="ifp-location-view" role="client">
        <map:query src="data/sql/location_get_summary.xml"/>
        <map:xsl src="templates/xsl/location_view.xsl"/>
	</map:gate>

	<!-- Add new image -->
	<map:gate name="ifp-location-image-edit" role="client">
		<map:if name="//_post">
            <map:true>
                <map:action type="upload" params="file,//_post/dest"/>
                <map:query src="data/sql/location_image_create.xml"/>
                <map:query src="data/sql/location_get_summary.xml"/>
                <map:query src="data/sql/location_get_images.xml"/>
                <map:action type="redirect" params="{//link_prefix}ifp-location-view&amp;location_id={//_post/location_id}"/>
            </map:true>
            <map:false>
            </map:false>
        </map:if>
		<map:query src="data/sql/location_get_summary.xml"/>
		<map:xsl src="templates/xsl/location_image_form.xsl"/>
	</map:gate>

	<!-- Delete image -->
	<map:gate name="ifp-location-image-delete" role="client">
		<map:query src="data/sql/location_image_delete.xml"/>
		<map:action type="redirect" params="{//link_prefix}ifp-locations"/>
	</map:gate>

	<!-- View location space plans -->
	<map:gate name="ifp-location-space-plans" role="client" cache="0">
        <map:query src="data/sql/location_get_summary.xml"/>
        <map:query src="data/sql/location_get_space_plans.xml"/>
        <map:query src="data/sql/equipment_types_get_all.xml"/>
        <map:xsl src="templates/xsl/location_space_plan.xsl"/>
	</map:gate>

	<map:gate name="ifp-location-space-plan-key-update" role="client">
		<map:query src="data/sql/edit_space_plan_key_position.xml"/>
	</map:gate>

	<!-- PDF OF FLOORPLAN -->
	<map:gate name="ifp-location-space-plan-pdf-server" role="client">
		<map:query src="data/sql/location_get_summary.xml"/>
		<map:query src="data/sql/location_get_space_plans.xml"/>
		<map:query src="data/sql/equipment_get_all_types.xml"/>
		<map:query src="data/sql/location_get_space_plan_by_id.xml"/>
		<map:query src="data/sql/location_get_space_plan_equipment.xml"/>
		<map:query src="data/sql/equipment_get_symbol_pointers.xml"/>
		<map:script src="lib/php/floorplan_pdf.php"/>
	</map:gate>



	<!-- Add new plan -->
	<map:gate name="ifp-location-space-plan-edit" role="client">
		<map:if name="//_post">
			<map:true>
				<map:action type="upload" params="file,//_post/dest"/>
				<map:script src="lib/php/floorplan_processor.php"/>
				<map:query src="data/sql/location_space_plan_create.xml"/>
                <map:action type="redirect"
                    params="{//link_prefix}ifp-location-space-plans&amp;location_id={//_post/location_id}"/>
			</map:true>
			<map:false>
				<!-- have to get user's account for destination variable of form - BAD! -->
				<map:query src="data/sql/location_get_summary.xml"/>
				<map:xsl src="templates/xsl/location_space_plan_form.xsl"/>
			</map:false>
		</map:if>
	</map:gate>

	<!-- Delete plan -->
	<map:gate name="ifp-location-space-plan-delete" role="client">
		<map:query src="data/sql/location_space_plan_delete.xml"/>
	</map:gate>
	<!-- edit space plan comments -->
	<map:gate name="ifp-location-space-plan-edit-dnu" role="client">
        <map:query src="data/sql/location_get_summary.xml"/>
        <map:query src="data/sql/get_location_space_plans.xml"/>
        <map:query src="data/sql/equipment_types_get_all.xml"/>
        <map:xsl src="templates/xsl/view_location_sp.xsl"/>
	</map:gate>

	<!-- View location equipment -->
	<map:gate name="ifp-location-equipment-quantities" role="client">
		<map:query src="data/sql/location_get_summary.xml"/>
		<map:query src="data/sql/equipment_types_get_all.xml"/>
		<map:query src="data/sql/location_get_equipment.xml"/>
		<map:xsl src="templates/xsl/location_equipment.xsl"/>
	</map:gate>

	<!-- View location equipment list -->
	<map:gate name="ifp-location-equipment-list" role="client">
		<map:query src="data/sql/equipment_types_get_all.xml"/>
        <map:query src="data/sql/location_get_summary.xml"/>
		<map:query src="data/sql/location_get_equipment.xml"/>
		<map:xsl src="templates/xsl/location_equipment_list.xsl"/>
	</map:gate>

	<!-- Edit location equipment -->
	<map:gate name="ifp-location-equipment-position-edit" role="client">
		<map:query src="data/sql/location_equipment_position_update.xml"/>
	</map:gate>

	<map:gate name="ifp-regions">
		<map:if name="//_post">
			<map:true>
                <map:query src="data/sql/regions_delete.xml"/>
                <map:action type="redirect" params="{//link_prefix}ifp-regions"/>
			</map:true>
			<map:false>
				<map:query src="data/sql/regions_get_all.xml"/>
				<map:query src="data/sql/locations_get_by_region_id.xml"/>
				<map:xsl src="templates/xsl/regions_view_all.xsl"/>
			</map:false>
		</map:if>
	</map:gate>

	<!-- New region -->
	<map:gate name="ifp-region-edit" role="client">
		<map:if name="_post/submit">
			<map:true>
                <map:if name="_post/region_id">
                    <map:true>
                        <map:query src="data/sql/region_update.xml"/>
                    </map:true>
                    <map:false>
                        <map:query src="data/sql/region_create.xml"/>
                    </map:false>
                </map:if>
				<map:query src="data/sql/region_locations_delete.xml"/>
				<map:query src="data/sql/region_locations_update.xml"/>
                <map:action type="redirect" params="{//link_prefix}ifp-regions"/>
            </map:true>
			<map:false>
			</map:false>
		</map:if>
        <map:query src="data/sql/region_get_by_id.xml"/>
        <map:query src="data/sql/locations_get_all.xml"/>
        <map:xsl src="templates/xsl/region_form.xsl"/>
	</map:gate>


	<!-- View all equipment -->
	<map:gate name="ifp-equipment" role="client">
		<map:query src="data/sql/equipment_get_all.xml"/>
		<map:xsl src="templates/xsl/equipment_view_all.xsl"/>
	</map:gate>
	<map:gate name="ifp-equipment-quantities" role="client">
		<map:query src="data/sql/equipment_types_get_all.xml"/>
		<map:query src="data/sql/get_all_equipment.xml"/>
		<map:xsl src="templates/xsl/view_all_equipment_q.xsl"/>
	</map:gate>
	<!-- New equipment form -->
	<map:gate name="ifp-equipment-edit" role="client">
		<map:if name="//_post/submit">
			<map:true>
				<map:switch name="//_post/type">
					<map:case value="new">
						<map:query src="data/sql/equipment_create.xml"/>
						<map:query src="data/sql/equipment_get_last_id.xml"/>
						<map:query src="data/sql/location_equipment_create.xml"/>
					</map:case>
					<map:case value="edit">
						<map:query src="data/sql/edit_equipment_container.xml"/>
					</map:case>
					<map:default>
					</map:default>
				</map:switch>
                <map:action type="redirect"
                    params="{//link_prefix}ifp-location-equipment-list&amp;location_id={//_post/location_id}"/>
			</map:true>
		</map:if>
		<map:query src="data/sql/location_get_summary.xml"/>
		<map:query src="data/sql/locations_get_all.xml"/>
		<map:query src="data/sql/equipment_types_get_all.xml"/>
		<map:if name="_get/equipment_id">
			<!-- EDIT FORM-->
			<map:true>
				<map:query src="data/sql/equipment_get_by_id.xml"/>
				<map:query src="data/sql/equipment_containers_get_by_id.xml"/>
				<map:xsl src="templates/xsl/equipment_form.xsl"/>
			</map:true>
			<map:false>
				<map:xsl src="templates/xsl/equipment_form.xsl"/>
			</map:false>
		</map:if>
	</map:gate>
	<map:gate name="ifp-equipment-edit-submit" role="client">
	<map:if name="//_post/submit">
		<map:true>
			<map:switch name="//_post/type">
				<map:case value="new">
					<map:query src="data/sql/equipment_create.xml"/>
                    <!--
					<map:query src="data/sql/get_last_equipment_id.xml"/>
					<map:query src="data/sql/add_equipment_location.xml"/>
					<map:query src="data/sql/get_last_location_equipment_id.xml"/>
					<map:query src="data/sql/add_equipment_location_position.xml"/>
                    -->
					<!-- get equipment_type containers-->
					<map:query src="data/sql/get_eqp_containers_by_type_id.xml"/>
					<!-- for each container, set default priorities and campaigns-->
					<map:query src="data/sql/equipment_containers_create.xml"/>
				</map:case>
				<map:case value="edit">
					<map:query src="data/sql/equipment_container_update.xml"/>
				</map:case>
				<map:default>
				</map:default>
			</map:switch>
			<map:action type="redirect" params="{//link_prefix}ifp-equipment"/>
		</map:true>
	</map:if>
	</map:gate>

	<!-- Delete equipment -->
	<map:gate name="ifp-equipment-delete" role="client">
		<map:query src="data/sql/equipment_delete.xml"/>
	</map:gate>


	<!-- equipment Types -->
	<map:gate name="ifp-equipment-types" role="client">
		<map:query src="data/sql/equipment_types_get_all.xml"/>
		<map:xsl src="templates/xsl/equipment_types.xsl"/>
	</map:gate>
	<!-- View equipment type images -->
	<map:gate name="ifp-equipment-type-images" role="client">
		<map:block name="type_images">
		<map:query src="data/sql/equipment_type_get_by_id.xml"/>
		<map:query src="data/sql/equipment_type_get_images.xml"/>
		<map:xsl src="templates/xsl/equipment_type_images.xsl"/>
		</map:block>
	</map:gate>

	<!-- Add new equipment image -->
	<map:gate name="ifp-equipment-type-edit" role="client">
		<map:if name="_post/submit">
            <map:true>
                <map:if name="_post/equipment_type_id">
                    <map:true>
                        <map:query src="data/sql/equipment_type_update.xml"/>
                    </map:true>
                    <map:false>
                        <map:query src="data/sql/equipment_type_create.xml"/>
                    </map:false>
                </map:if>
                <map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
            </map:true>
            <map:false>
            </map:false>
		</map:if>
		<map:query src="data/sql/equipment_type_get_by_id.xml"/>
		<map:xsl src="templates/xsl/equipment_type_form.xsl"/>
	</map:gate>

	<map:gate name="ifp-equipment-type-edit-submit" role="client">
		<map:if name="_post/submit">
			<map:true>
                <map:query src="data/sql/equipment_image_create.xml"/>
				<map:insert name="type_images"/>
             </map:true>
			<map:false>
				<map:xsl src="templates/xsl/equipment_image_form.xsl"/>
			</map:false>
		</map:if>
	</map:gate>
	<map:gate name="ifp-equipment-type-delete" role="client">
		<map:query src="data/sql/equipment_type_image_delete.xml"/>
        <map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
	</map:gate>

	<!-- Add new plan symbol -->
	<map:gate name="ifp-equipment-type-icon-edit" role="client">
		<map:query src="data/sql/equipment_type_get_by_id.xml"/>
		<map:xsl src="templates/xsl/equipment_type_icon_form.xsl"/>
	</map:gate>

	<map:gate name="ifp-equipment-type-icon-edit-submit" role="client">
		<map:if name="_post/submit">
			<map:true>
                <map:action type="upload" params="file,//_post/dest"/>
                <map:script src="lib/php/symbol_processor.php"/>
                <map:query src="data/sql/equipment_type_icon_create.xml"/>
                <map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
			</map:true>
			<map:false>
				<map:xsl src="templates/xsl/equipment_type_icon_form.xsl"/>
			</map:false>
		</map:if>
	</map:gate>
    
	<!-- Delete symbol -->
	<map:gate name="ifp-equipment-type-icon-edit-delete" role="client">
		<map:query src="data/sql/equipment_type_icon_delete.xml"/>
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
	</map:gate>

	<!-- View equipment type symbols -->
	<map:gate name="ifp-equipment-type-icons" role="client">
		<map:query src="data/sql/equipment_type_get_by_id.xml"/>
		<map:query src="data/sql/equipment_type_get_icons.xml"/>
		<map:xsl src="templates/xsl/equipment_type_icons.xsl"/>
	</map:gate>

	<!-- Delete equipment Types -->
	<map:gate name="ifp-equipment-type-delete" role="client">
		<map:query src="data/sql/equipment_type_delete.xml"/>
	</map:gate>

	<!-- CONFIGURE EQUIPMENT CONTAINERS -->
	<map:gate name="ifp-equipment-type-containers">
		<map:query src="data/sql/equipment_type_get_by_id.xml"/>
		<map:xsl src="templates/xsl/equipment_containers.xsl"/>
	</map:gate>
	<!-- ADD EQUIPMENT CONTAINERS -->
	<map:gate name="ifp-equipment-type-container-edit">
		<map:query src="data/sql/equipment_containers_create.xml"/>
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
	</map:gate>
	<!-- DELETE EQUIPMENT CONTAINERS -->
	<map:gate name="ifp-equipment-type-container-delete">
		<map:query src="data/sql/equipment_containers_delete.xml"/>
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
	</map:gate>

	<!-- LIST CONTAINERS -->
	<map:gate name="ifp-containers" >
		<map:query src="data/sql/container_types_get_all.xml"/>
		<map:xsl src="templates/xsl/view_container_types.xsl"/>
	</map:gate>

	<!-- ADD CONTAINER -->
    <map:gate name="ifp-containers-edit" role="client">
        <map:query src="data/sql/container_type_get_by_id.xml"/>
        <map:xsl src="templates/xsl/container_type_form.xsl"/>
    </map:gate>

<map:gate name="ifp-containers-edit-submit" role="client">
	<map:switch name="_post/type">
		<map:case value="new">
			<map:query src="data/sql/new_container_type.xml"/>
		</map:case>
		<map:case value="edit">
			<map:query src="data/sql/del_container_type.xml"/>
			<map:query src="data/sql/edit_container_type.xml"/>
		</map:case>
		<map:default>
			<map:query src="data/sql/new_container_type.xml"/>
		</map:default>
	</map:switch>
		<map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
</map:gate>

<!-- DELETE CONTAINER TYPE-->
<map:gate name="ifp-containers-delete" role="client">
	<map:query src="data/sql/del_container_type.xml"/>
    <map:action type="redirect" params="{//link_prefix}ifp-equipment-types"/>
</map:gate>

<!-- Symbol and Image servers -->
	<map:gate name="ifp-types-display" role="client">
		<map:query src="data/sql/equipment_get_by_id_p.xml"/>
		<map:query src="data/sql/post_eqp_containers_by_type_id.xml"/>
		<map:xsl src="templates/xsl/display_equipment_config.xsl"/>
	</map:gate>


	<map:gate name="ifp-equipment-types-symbol-server" role="client">
		<map:query src="data/sql/get_symbol_pointer_by_id.xml"/>
		<map:script src="lib/php/show_symbol.php" />
	</map:gate>

	<!-- FLASH SERVER!!!! -->
	<map:gate name="ifp-types-containers-position-server">
        <map:action type="header" params="Content-Type,application/x-shockwave-flash"/>
		<map:query src="data/sql/get_eqp_containers_by_type_id.xml"/>
		<map:query src="data/sql/get_image_pointer_by_id.xml"/>
		<map:script src="lib/php/display_position_containers.php" />
	</map:gate>
	<!-- CONTAINER POSITIONER -->
	<map:gate name="ifp-container-position" role="client">
		<map:query src="data/sql/pos_equipment_container.xml"/>
	</map:gate>

	<!-- CONTENT DISPLAYER ON MERCHANDISING -->
	<map:gate name="ifp-content-position-server" role="client">
        <map:action type="header" params="Content-Type,application/x-shockwave-flash"/>
		<map:query src="data/sql/get_eqp_containers_by_type_id.xml"/>
		<map:query src="data/sql/get_image_pointer_by_id.xml"/>
		<map:query src="data/sql/get_equipment_content.xml"/>
		<map:query src="data/sql/get_image_pointers_by_id.xml"/>
		<map:script src="lib/php/display_equipment_setup.php" />
	</map:gate>

	<!-- MING SPACE PLAN SERVER -->
	<map:gate name="ifp-location-space-plan-server" role="client" cache="0">
        <map:action type="header" params="Content-Type,application/x-shockwave-flash"/>
		<map:query src="data/sql/location_get_space_plan_by_id.xml"/>
		<map:query src="data/sql/location_get_space_plan_equipment.xml"/>
		<map:query src="data/sql/equipment_get_symbol_pointers.xml"/>
		<map:script src="lib/php/floorplan_generator.php" />
	</map:gate>


<map:gate name="ifp-options">
    <map:xml src="data/xml/ifp_options.xml"/>
    <map:if name="//_post">
        <map:true>
            <map:query src="data/sql/option_delete.xml"/>
            <map:query src="data/sql/option_update.xml"/>
            <map:action type="redirect" params="{//link_prefix}ifp-options"/>
        </map:true>
        <map:false>
        </map:false>
    </map:if>
    <map:query src="data/sql/option_get.xml"/>
    <map:xsl src="templates/xsl/options.xsl"/>
</map:gate>

    <map:gate name="ifp-iframe-viewer" cache="0">
        <map:xsl src="templates/xsl/ifp_iframe_viewer.xsl"/>
    </map:gate>
    <map:gate name="ifp-themed-css" cache="0">
        <map:action type="header" params="Content-Type,text/css"/>
        <map:raw src="templates/themes/{//theme}/default.css" />
    </map:gate>
    <map:gate name="dynamic-css" cache="0">
        <map:action type="header" params="Content-Type,text/css"/>
        <map:xsl src="templates/themes/{//theme}/default.css.xsl"/>
    </map:gate>

    <map:gate name="license" cache="0">
        <map:action type="header" params="Content-Type,text/plain"/>
        <map:raw src="LICENSE" />
    </map:gate>
    <map:gate name="readme" cache="0">
        <map:action type="header" params="Content-Type,text/plain"/>
        <map:raw src="README" />
    </map:gate>
</map:sitemap>
